<div className="js-inline-admin-formset inline-group" id="{{ inline_formset.prefix }}-group" data-inline-type="tabular"
     data-inline-formset="{{ inline_formset.inline_formset_data }}">
  <div className="tabular inline-related">
    {{ inline_formset.management_form }}
    <fieldset className="module {{ inline_formset.classes }}">
      <h2 style="background-color: {{ color  }}">{{ label }}</h2>
      {{ inline_formset.non_form_errors }}
      <table>
        <thead>
        <tr>
          {% for field in inline_formset.0 %}
          <th className="column-{{ field.name }}{% if field.required %} required{% endif %}">
            {% if not field.is_hidden %} {{ field.label_tag }} {% endif %}
          </th>
          {% endfor %}
        </tr>
        </thead>

        <tbody>
        {% for form in inline_formset %}
        <tr className="form-row">
          {% for field in form %} {% if field.is_readonly %}
          <p>{{ field.contents }}</p>
          {% else %}
          <td>{{ field.errors }} {{ field }}</td>
          {% endif %} {% endfor %}
        </tr>
        {% endfor %}
        <tr className="add-row">
          <td colSpan="{{ inline_formset.extra|add:'1' }}">
            <a href="#" className="add-info" id="{{ label|cut:" "|lower }}">{{ title_add }}</a>
          </td>
        </tr>
        </tbody>
      </table>
    </fieldset>
  </div>
  <script type="text/javascript">
    document.querySelector('#{{ label|cut:" "|lower }}').onclick = function (e) {
      e.preventDefault();
      let target = e.target;
      let next_id = parseInt(target.parentNode.getAttribute("colspan")); //previousSibling;
      let html = `
          <tr class="form-row">
            {% for field in inline_formset.0 %}
                {% if field.is_readonly %}
                    <p>{{ field.contents }}</p>
                {% else %}
                  <td>
                    {{ field.errors }}
                    {{ field }}
                  </td>
                {% endif %}
            {% endfor %}
          </tr>
    `.replaceAll("0", next_id);
      // Internet Explorer, Opera, Chrome, Firefox 8+ and Safari
      let el = target.parentElement.parentElement.previousElementSibling;
      if (el.insertAdjacentHTML) el.insertAdjacentHTML("afterend", html);
      else {
        var range = document.createRange();
        var frag = range.createContextualFragment(html);
        el.parentNode.insertBefore(frag, el);
      }
      target.parentNode.setAttribute("colspan", next_id);
    }
  </script>
</div>